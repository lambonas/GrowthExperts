---
interface Props {
  author: {
    name: string;
    role: string;
    bio: string;
    avatar?: ImageMetadata;
    social?: {
      linkedin?: string;
      twitter?: string;
    };
  };
  variant: 'small' | 'large';
  showViewAll?: boolean;
}

const { author, variant, showViewAll = false } = Astro.props;
const { name, role, bio, avatar, social } = author;

const maxBioLength = variant === 'small' ? 120 : 300;
const truncatedBio = bio.length > maxBioLength ? bio.substring(0, maxBioLength) + '...' : bio;
---

<div class={`bg-gray-50 rounded-xl p-6 border border-gray-200 ${variant === 'large' ? 'lg:flex lg:items-start lg:gap-6' : ''}`}>
  <div class={`flex items-start gap-4 ${variant === 'large' ? 'lg:flex-shrink-0' : ''}`}>
    <!-- Avatar -->
    <div class={`flex-shrink-0 rounded-full bg-gradient-to-br from-primary-100 to-secondary-100 flex items-center justify-center overflow-hidden ${variant === 'large' ? 'w-24 h-24' : 'w-16 h-16'}`}>
      {avatar ? (
        <img src={avatar.src} alt={name} class="w-full h-full object-cover" />
      ) : (
        <svg class={`text-primary-600 ${variant === 'large' ? 'w-12 h-12' : 'w-8 h-8'}`} fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" />
        </svg>
      )}
    </div>

    <!-- Info -->
    <div class="flex-1">
      <h3 class={`font-bold font-display text-gray-900 ${variant === 'large' ? 'text-xl mb-1' : 'text-base mb-1'}`}>
        {name}
      </h3>
      <p class={`text-gray-600 ${variant === 'large' ? 'text-sm mb-2' : 'text-xs mb-2'}`}>
        {role}
      </p>

      {variant === 'large' && (
        <>
          <p class="text-gray-700 text-sm leading-relaxed mb-4">
            {truncatedBio}
          </p>

          <!-- Social Links & View All -->
          <div class="flex items-center gap-4">
            {social?.linkedin && (
              <a
                href={social.linkedin}
                target="_blank"
                rel="noopener noreferrer"
                class="inline-flex items-center gap-2 text-sm text-primary-600 hover:text-primary-700 font-semibold"
                aria-label={`${name} on LinkedIn`}
              >
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M6.29 18.25c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0020 3.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.073 4.073 0 01.8 7.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 010 16.407a11.616 11.616 0 006.29 1.84" />
                </svg>
                LinkedIn
              </a>
            )}
            {showViewAll && (
              <a
                href="/blog/"
                class="inline-flex items-center gap-1 text-sm text-gray-600 hover:text-primary-600 font-semibold group"
              >
                View All Posts
                <svg class="w-4 h-4 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </a>
            )}
          </div>
        </>
      )}

      {variant === 'small' && (
        <>
          <p class="text-gray-600 text-xs leading-relaxed mb-3 line-clamp-2">
            {truncatedBio}
          </p>
          {showViewAll && (
            <a
              href="/blog/"
              class="inline-flex items-center gap-1 text-xs text-primary-600 hover:text-primary-700 font-semibold group"
            >
              View All Posts
              <svg class="w-3 h-3 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          )}
        </>
      )}
    </div>
  </div>
</div>
