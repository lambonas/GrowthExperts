---
import { ViewTransitions } from 'astro:transitions';
import SEO from '../components/seo/SEO.astro';
import SchemaOrg from '../components/seo/SchemaOrg.astro';

// Import Fontsource fonts - only necessary weights
import '@fontsource/inter/400.css';
import '@fontsource/inter/600.css';
import '@fontsource/inter/700.css';
import '@fontsource/poppins/400.css';
import '@fontsource/poppins/600.css';
import '@fontsource/poppins/700.css';

import '../styles/global.css';

export interface Props {
  title: string;
  description: string;
  canonical?: string;
  ogImage?: string;
  ogType?: 'website' | 'article' | 'profile';
  noindex?: boolean;
  nofollow?: boolean;
  keywords?: string[];
  schema?: {
    type: 'Organization' | 'Service' | 'LocalBusiness' | 'Article' | 'FAQPage' | 'BreadcrumbList';
    data: Record<string, any>;
  };
}

const {
  title,
  description,
  canonical,
  ogImage,
  ogType = 'website',
  noindex = false,
  nofollow = false,
  keywords = [],
  schema,
} = Astro.props;
---

<!doctype html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="generator" content={Astro.generator} />

    <!-- SEO Component -->
    <SEO
      title={title}
      description={description}
      canonical={canonical}
      ogImage={ogImage}
      ogType={ogType}
      noindex={noindex}
      nofollow={nofollow}
      keywords={keywords}
    />

    <!-- Schema.org Structured Data -->
    {
      schema && (
        <SchemaOrg type={schema.type} data={schema.data} />
      )
    }

    <!-- Always include Organization schema -->
    {!schema && <SchemaOrg type="Organization" data={{}} />}

    <!-- Additional head content slot -->
    <slot name="head" />

    <!-- Favicons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <!-- Sitemap -->
    <link rel="sitemap" href="/sitemap-index.xml" />

    <!-- View Transitions -->
    <ViewTransitions />
  </head>
  <body class="antialiased">
    <!-- Skip to main content for accessibility -->
    <a
      href="#main-content"
      class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary-600 focus:text-white focus:rounded-lg"
    >
      Skip to main content
    </a>

    <slot />

    <!-- Optional: Add analytics script here -->
    <!-- <script is:inline>
      // Analytics code
    </script> -->
  </body>
</html>

<style is:global>
  /* Tailwind screen reader only utility */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  .not-sr-only {
    position: static;
    width: auto;
    height: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    clip: auto;
    white-space: normal;
  }
</style>
